<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8"/>
  <title>SVRIOT â€¢ SQLi Scanner</title>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <!-- Fonts & Icons -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/lucide@0.263.1/dist/iconfont/lucide.min.css" rel="stylesheet">
  <style>
    :root{
      --bg:#0d0d0d;
      --bg-card:#1a1a1a;
      --accent:#00f5d4;
      --text:#ffffff;
      --text-sec:#a1a1aa;
    }
    [data-theme="light"]{
      --bg:#fafafa;
      --bg-card:#ffffff;
      --accent:#0077ff;
      --text:#111;
      --text-sec:#555;
    }
    *{box-sizing:border-box;font-family:Inter,sans-serif;margin:0;padding:0}
    body{
      background:var(--bg);color:var(--text);
      display:flex;align-items:center;justify-content:center;
      min-height:100vh;padding:1rem;
      transition:background .3s,color .3s;
    }
    .glass{
      background:rgba(255,255,255,.05);
      backdrop-filter:blur(12px);
      border:1px solid rgba(255,255,255,.08);
      border-radius:24px;
      padding:2.5rem 2rem;
      max-width:420px;
      width:100%;
      text-align:center;
      box-shadow:0 25px 50px -12px rgba(0,0,0,.4);
    }
    .logo{font-size:1.9rem;font-weight:700;margin-bottom:.5rem;color:var(--accent)}
    .subtitle{color:var(--text-sec);font-size:.85rem;margin-bottom:2rem}
    input{
      width:100%;padding:1rem 1.2rem;border-radius:14px;border:none;
      background:var(--bg-card);color:var(--text);font-size:.95rem;
      margin-bottom:1rem;
    }
    button{
      width:100%;padding:1rem;border-radius:14px;border:none;
      background:var(--accent);color:#000;font-weight:600;cursor:pointer;
      transition:transform .2s,opacity .2s;
    }
    button:disabled{opacity:.6;cursor:not-allowed;transform:none}
    .fade{animation:fadeIn .4s ease-in-out}
    @keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:none}}
    .result{margin-top:1.5rem}
    .card{
      background:var(--bg-card);
      border-radius:14px;
      padding:1rem 1.25rem;
      text-align:left;
      display:none;
      position:relative;
    }
    .vuln{border-left:4px solid #ff4d4d}
    .safe{border-left:4px solid #00f5d4}
    .error{border-left:4px solid #ffa600}
    .skeleton{
      height:1rem;background:rgba(255,255,255,.08);border-radius:6px;
      animation:pulse 1.2s infinite;
    }
    @keyframes pulse{0%,100%{opacity:.4}50%{opacity:1}}
    .theme-toggle{
      position:absolute;top:1rem;right:1rem;background:none;border:none;
      color:var(--text);font-size:1.4rem;cursor:pointer;
    }
    .toast{
      position:fixed;bottom:2rem;left:50%;
      transform:translateX(-50%) translateY(120%);
      background:var(--accent);color:#000;padding:.75rem 1.5rem;border-radius:10px;
      font-size:.9rem;font-weight:500;transition:transform .3s;
    }
    .toast.show{transform:translateX(-50%) translateY(0)}
  </style>
</head>
<body>
  <button class="theme-toggle" id="toggleTheme"><i data-lucide="sun"></i></button>

  <div class="glass">
    <div class="logo">SVRIOT</div>
    <div class="subtitle">Advanced SQL-Injection Scanner</div>

    <input id="url" type="url" placeholder="https://target.com/page?id=1">
    <button id="scanBtn">Scan</button>

    <div class="result">
      <!-- Skeleton loading -->
      <div id="loading" class="card fade" style="display:none">
        <div class="skeleton" style="width:60%"></div>
        <div class="skeleton" style="width:90%;margin-top:.5rem"></div>
      </div>

      <!-- Hasil scan -->
      <div id="resultCard" class="card fade"></div>
    </div>
  </div>

  <div class="toast" id="toast"></div>

  <script src="https://unpkg.com/lucide@latest"></script>
  <script>
    lucide.createIcons();

    const toggleBtn = document.getElementById('toggleTheme');
    const html = document.documentElement;
    const saved = localStorage.getItem('theme');
    if (saved) html.setAttribute('data-theme', saved);

    toggleBtn.onclick = () => {
      const current = html.getAttribute('data-theme') === 'light' ? 'dark' : 'light';
      html.setAttribute('data-theme', current);
      localStorage.setItem('theme', current);
      lucide.createIcons();
    };

    const urlEl = document.getElementById('url');
    const btn = document.getElementById('scanBtn');
    const loading = document.getElementById('loading');
    const resultCard = document.getElementById('resultCard');

    const toast = (msg) => {
      const t = document.getElementById('toast');
      t.textContent = msg;
      t.classList.add('show');
      setTimeout(()=>t.classList.remove('show'), 3000);
    };

    btn.onclick = async () => {
      const url = urlEl.value.trim();
      if (!url) return toast('URL masih kosong');

      btn.disabled = true;
      loading.style.display = 'block';
      resultCard.style.display = 'none';

      try {
        const res = await fetch(`/api/scan?url=${encodeURIComponent(url)}`);
        const data = await res.json();
        loading.style.display = 'none';
        resultCard.style.display = 'block';
        resultCard.className = 'card fade ' + data.status;
        resultCard.innerHTML = `
          <div style="font-weight:600;margin-bottom:.25rem">${data.status.toUpperCase()}</div>
          <div style="color:var(--text-sec);word-break:break-word">${data.detail}</div>
          <button style="margin-top:.75rem;padding:.4rem .8rem;font-size:.8rem"
                  onclick="navigator.clipboard.writeText('${JSON.stringify(data)}')">
            ðŸ“‹ Copy Result
          </button>
        `;
        toast('Scan selesai');
      } catch (e) {
        loading.style.display = 'none';
        toast('Gagal terhubung');
      } finally {
        btn.disabled = false;
      }
    };
  </script>
</body>
</html>
